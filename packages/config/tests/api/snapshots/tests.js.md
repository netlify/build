# Snapshot report for `packages/config/tests/api/tests.js`

The actual snapshot is saved in `tests.js.snap`.

Generated by [AVA](https://ava.li).

## --site-id

> Snapshot 1

    `{␊
      "branch": "branch",␊
      "buildDir": "/file/path",␊
      "config": {␊
        "build": {␊
          "environment": {},␊
          "lifecycle": {}␊
        },␊
        "plugins": []␊
      },␊
      "configPath": "/file/path",␊
      "context": "production",␊
      "siteInfo": {␊
        "id": "test"␊
      }␊
    }`

## --token

> Snapshot 1

    `{␊
      "branch": "branch",␊
      "buildDir": "/file/path",␊
      "config": {␊
        "build": {␊
          "environment": {},␊
          "lifecycle": {}␊
        },␊
        "plugins": []␊
      },␊
      "configPath": "/file/path",␊
      "context": "production",␊
      "hasApi": true,␊
      "siteInfo": {}␊
    }`

## Build settings are not used if getSite call fails

> Snapshot 1

    `{␊
      "branch": "branch",␊
      "buildDir": "/file/path",␊
      "config": {␊
        "build": {␊
          "environment": {},␊
          "lifecycle": {}␊
        },␊
        "plugins": []␊
      },␊
      "configPath": "/file/path",␊
      "context": "production",␊
      "hasApi": true,␊
      "siteInfo": {␊
        "id": "test"␊
      }␊
    }`

## Build settings are not used in CI

> Snapshot 1

    `{␊
      "branch": "branch",␊
      "buildDir": "/file/path",␊
      "config": {␊
        "build": {␊
          "environment": {},␊
          "lifecycle": {}␊
        },␊
        "plugins": []␊
      },␊
      "configPath": "/file/path",␊
      "context": "production",␊
      "hasApi": true,␊
      "siteInfo": {␊
        "id": "test"␊
      }␊
    }`

## Build settings are not used without a siteId

> Snapshot 1

    `{␊
      "branch": "branch",␊
      "buildDir": "/file/path",␊
      "config": {␊
        "build": {␊
          "environment": {},␊
          "lifecycle": {}␊
        },␊
        "plugins": []␊
      },␊
      "configPath": "/file/path",␊
      "context": "production",␊
      "hasApi": true,␊
      "siteInfo": {}␊
    }`

## Build settings are not used without a token

> Snapshot 1

    `{␊
      "branch": "branch",␊
      "buildDir": "/file/path",␊
      "config": {␊
        "build": {␊
          "environment": {},␊
          "lifecycle": {}␊
        },␊
        "plugins": []␊
      },␊
      "configPath": "/file/path",␊
      "context": "production",␊
      "siteInfo": {␊
        "id": "test"␊
      }␊
    }`

## Build settings have low merging priority

> Snapshot 1

    `{␊
      "branch": "branch",␊
      "buildDir": "/file/path",␊
      "config": {␊
        "build": {␊
          "base": "/file/path",␊
          "environment": {␊
            "TEST_ENV": "fixture"␊
          },␊
          "functions": "/file/path",␊
          "lifecycle": {␊
            "onBuild": "fixtureCommand"␊
          },␊
          "publish": "/file/path"␊
        },␊
        "plugins": []␊
      },␊
      "configPath": "/file/path",␊
      "context": "production",␊
      "hasApi": true,␊
      "siteInfo": {␊
        "build_settings": {␊
          "base": "base",␊
          "base_rel_dir": false,␊
          "cmd": "testCommand",␊
          "dir": "testPublish",␊
          "env": {␊
            "TEST_ENV": "test"␊
          },␊
          "functions_dir": "testFunctions"␊
        },␊
        "id": "test",␊
        "url": "test"␊
      }␊
    }`

## Environment variable siteInfo API error

> Snapshot 1

    `{␊
      "branch": "branch",␊
      "buildDir": "/file/path",␊
      "config": {␊
        "build": {␊
          "environment": {},␊
          "lifecycle": {}␊
        },␊
        "plugins": []␊
      },␊
      "configPath": "/file/path",␊
      "context": "production",␊
      "hasApi": true,␊
      "siteInfo": {␊
        "id": "test"␊
      }␊
    }`

## Environment variable siteInfo CI

> Snapshot 1

    `{␊
      "branch": "branch",␊
      "buildDir": "/file/path",␊
      "config": {␊
        "build": {␊
          "environment": {},␊
          "lifecycle": {}␊
        },␊
        "plugins": []␊
      },␊
      "configPath": "/file/path",␊
      "context": "production",␊
      "hasApi": true,␊
      "siteInfo": {␊
        "id": "test"␊
      }␊
    }`

## Environment variable siteInfo no siteId

> Snapshot 1

    `{␊
      "branch": "branch",␊
      "buildDir": "/file/path",␊
      "config": {␊
        "build": {␊
          "environment": {},␊
          "lifecycle": {}␊
        },␊
        "plugins": []␊
      },␊
      "configPath": "/file/path",␊
      "context": "production",␊
      "hasApi": true,␊
      "siteInfo": {}␊
    }`

## Environment variable siteInfo no token

> Snapshot 1

    `{␊
      "branch": "branch",␊
      "buildDir": "/file/path",␊
      "config": {␊
        "build": {␊
          "environment": {},␊
          "lifecycle": {}␊
        },␊
        "plugins": []␊
      },␊
      "configPath": "/file/path",␊
      "context": "production",␊
      "siteInfo": {␊
        "id": "test"␊
      }␊
    }`

## Environment variable siteInfo success

> Snapshot 1

    `{␊
      "branch": "branch",␊
      "buildDir": "/file/path",␊
      "config": {␊
        "build": {␊
          "environment": {},␊
          "lifecycle": {}␊
        },␊
        "plugins": []␊
      },␊
      "configPath": "/file/path",␊
      "context": "production",␊
      "hasApi": true,␊
      "siteInfo": {␊
        "build_settings": {␊
          "repo_url": "test"␊
        },␊
        "id": "test",␊
        "url": "test"␊
      }␊
    }`

## NETLIFY_AUTH_TOKEN environment variable

> Snapshot 1

    `{␊
      "branch": "branch",␊
      "buildDir": "/file/path",␊
      "config": {␊
        "build": {␊
          "environment": {},␊
          "lifecycle": {}␊
        },␊
        "plugins": []␊
      },␊
      "configPath": "/file/path",␊
      "context": "production",␊
      "hasApi": true,␊
      "siteInfo": {}␊
    }`

## Use build settings if a siteId and token are provided

> Snapshot 1

    `{␊
      "branch": "branch",␊
      "buildDir": "/file/path",␊
      "config": {␊
        "build": {␊
          "base": "/file/path",␊
          "environment": {␊
            "TEST_ENV": "test"␊
          },␊
          "functions": "/file/path",␊
          "lifecycle": {␊
            "onBuild": "testCommand"␊
          },␊
          "publish": "/file/path"␊
        },␊
        "plugins": []␊
      },␊
      "configPath": "/file/path",␊
      "context": "production",␊
      "hasApi": true,␊
      "siteInfo": {␊
        "build_settings": {␊
          "base": "base",␊
          "base_rel_dir": false,␊
          "cmd": "testCommand",␊
          "dir": "testPublish",␊
          "env": {␊
            "TEST_ENV": "test"␊
          },␊
          "functions_dir": "testFunctions"␊
        },␊
        "id": "test",␊
        "url": "test"␊
      }␊
    }`
