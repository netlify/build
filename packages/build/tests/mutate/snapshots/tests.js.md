# Snapshot report for `tests/mutate/tests.js`

The actual snapshot is saved in `tests.js.snap`.

Generated by [AVA](https://avajs.dev).

## Pass netlifyConfig to plugins

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/valid␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/valid␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/valid/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/valid␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    true␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig properties are readonly (set) by default

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/readonly_set␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/readonly_set␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/readonly_set/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/readonly_set␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "build.ignore" value changed to ''.␊
    ␊
    Plugin "./plugin" internal error                              ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: "netlifyConfig.build.ignore" is read-only.␊
    ␊
      Plugin details␊
      Package:        ./plugin␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onPreBuild" event in "./plugin" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/readonly_set␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin`

## netlifyConfig properties are readonly (delete) by default

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/readonly_delete␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/readonly_delete␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/readonly_delete/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        command: test␊
        commandOrigin: config␊
        publish: packages/build/tests/mutate/fixtures/readonly_delete␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    Plugin "./plugin" internal error                              ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: Setting "netlifyConfig.build.command" to undefined is not allowed.␊
      Please set this property to a specific value instead.␊
    ␊
      Plugin details␊
      Package:        ./plugin␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onPreBuild" event in "./plugin" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        command: test␊
        commandOrigin: config␊
        publish: packages/build/tests/mutate/fixtures/readonly_delete␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin`

## netlifyConfig properties are readonly (defineProperty) by default

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/readonly_define␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/readonly_define␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/readonly_define/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/readonly_define␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "build.ignore" value changed to ''.␊
    ␊
    Plugin "./plugin" internal error                              ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: "netlifyConfig.build.ignore" is read-only.␊
    ␊
      Plugin details␊
      Package:        ./plugin␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onPreBuild" event in "./plugin" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/readonly_define␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin`

## Some netlifyConfig properties can be mutated

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/general␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/general␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/general/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/general␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./one␊
        - inputs: {}␊
          origin: config␊
          package: ./two␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./one@1.0.0 from netlify.toml␊
       - ./two@1.0.0 from netlify.toml␊
    ␊
    ./one (onPreBuild event)                                      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "functions.directory" value changed to 'test_functions'.␊
    ␊
    > Updated config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/general␊
        publishOrigin: default␊
      functionsDirectory: packages/build/tests/mutate/fixtures/general/test_functions␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./one␊
        - inputs: {}␊
          origin: config␊
          package: ./two␊
    ␊
    (./one onPreBuild completed in 1ms)␊
    Build step duration: ./one onPreBuild completed in 1ms␊
    ␊
    ./one (onBuild event)                                         ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    packages/build/tests/mutate/fixtures/general/test_functions␊
    ␊
    (./one onBuild completed in 1ms)␊
    Build step duration: ./one onBuild completed in 1ms␊
    ␊
    ./two (onBuild event)                                         ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    packages/build/tests/mutate/fixtures/general/test_functions␊
    ␊
    (./two onBuild completed in 1ms)␊
    Build step duration: ./two onBuild completed in 1ms␊
    ␊
    Functions bundling                                            ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    No Functions were found in test_functions directory␊
    ␊
    (Functions bundling completed in 1ms)␊
    Build step duration: Functions bundling completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig properties cannot be deleted

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/delete␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/delete␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/delete/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        command: test␊
        commandOrigin: config␊
        publish: packages/build/tests/mutate/fixtures/delete␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onPreBuild event)                                ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    Plugin "./plugin.js" internal error                           ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: Setting "netlifyConfig.build.command" to undefined is not allowed.␊
      Please set this property to a specific value instead.␊
    ␊
      Plugin details␊
      Package:        ./plugin.js␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onPreBuild" event in "./plugin.js" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        command: test␊
        commandOrigin: config␊
        publish: packages/build/tests/mutate/fixtures/delete␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js`

## netlifyConfig properties cannot be assigned to undefined

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/set_undefined␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/set_undefined␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/set_undefined/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        command: test␊
        commandOrigin: config␊
        publish: packages/build/tests/mutate/fixtures/set_undefined␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onPreBuild event)                                ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    Plugin "./plugin.js" internal error                           ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: Setting "netlifyConfig.build.command" to undefined is not allowed.␊
      Please set this property to a specific value instead.␊
    ␊
      Plugin details␊
      Package:        ./plugin.js␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onPreBuild" event in "./plugin.js" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        command: test␊
        commandOrigin: config␊
        publish: packages/build/tests/mutate/fixtures/set_undefined␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js`

## netlifyConfig properties cannot be assigned to null

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/set_null␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/set_null␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/set_null/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        command: test␊
        commandOrigin: config␊
        publish: packages/build/tests/mutate/fixtures/set_null␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onPreBuild event)                                ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    Plugin "./plugin.js" internal error                           ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: Setting "netlifyConfig.build.command" to null is not allowed.␊
      Please set this property to a specific value instead.␊
    ␊
      Plugin details␊
      Package:        ./plugin.js␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onPreBuild" event in "./plugin.js" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        command: test␊
        commandOrigin: config␊
        publish: packages/build/tests/mutate/fixtures/set_null␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js`

## netlifyConfig properties cannot be assigned to undefined with defineProperty

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/define_undefined␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/define_undefined␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/define_undefined/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        command: test␊
        commandOrigin: config␊
        publish: packages/build/tests/mutate/fixtures/define_undefined␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onPreBuild event)                                ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    Plugin "./plugin.js" internal error                           ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: Setting "netlifyConfig.build.command" to undefined is not allowed.␊
      Please set this property to a specific value instead.␊
    ␊
      Plugin details␊
      Package:        ./plugin.js␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onPreBuild" event in "./plugin.js" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        command: test␊
        commandOrigin: config␊
        publish: packages/build/tests/mutate/fixtures/define_undefined␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js`

## netlifyConfig properties mutations is persisted

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/persist␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/persist␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/persist/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/persist␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "build.command" value changed to 'node --version'.␊
    ␊
    > Updated config␊
      build:␊
        command: node --version␊
        commandOrigin: inline␊
        publish: packages/build/tests/mutate/fixtures/persist␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    build.command from a plugin                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    $ node --version␊
    v1.0.0␊
    ␊
    (build.command completed in 1ms)␊
    Build step duration: build.command completed in 1ms␊
    ␊
    ./plugin (onBuild event)                                      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "functions.*.external_node_modules" value changed to [ 'test' ].␊
    ␊
    > Updated config␊
      build:␊
        command: node --version␊
        commandOrigin: inline␊
        publish: packages/build/tests/mutate/fixtures/persist␊
        publishOrigin: default␊
      functions:␊
        '*':␊
          external_node_modules:␊
            - test␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onBuild completed in 1ms)␊
    Build step duration: ./plugin onBuild completed in 1ms␊
    ␊
    ./plugin (onPostBuild event)                                  ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    node --version␊
    [ 'test' ]␊
    ␊
    (./plugin onPostBuild completed in 1ms)␊
    Build step duration: ./plugin onPostBuild completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig array properties can be mutated per index

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/array_index␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/array_index␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/array_index/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/array_index␊
        publishOrigin: default␊
      functions:␊
        '*':␊
          included_files:␊
            - one␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "functions.*.included_files" value changed to [ 'one', 'two' ].␊
    ␊
    > Updated config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/array_index␊
        publishOrigin: default␊
      functions:␊
        '*':␊
          included_files:␊
            - one␊
            - two␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig array properties can be pushed

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/array_push␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/array_push␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/array_push/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/array_push␊
        publishOrigin: default␊
      functions:␊
        '*':␊
          included_files:␊
            - one␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "functions.*.included_files" value changed to [ 'one', 'two' ].␊
    ␊
    > Updated config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/array_push␊
        publishOrigin: default␊
      functions:␊
        '*':␊
          included_files:␊
            - one␊
            - two␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig.functionsDirectory mutations are used during functions bundling

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/functions_directory_bundling␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/functions_directory_bundling␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/functions_directory_bundling/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_directory_bundling␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "functions.directory" value changed to 'test_functions'.␊
    ␊
    > Updated config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_directory_bundling␊
        publishOrigin: default␊
      functionsDirectory: packages/build/tests/mutate/fixtures/functions_directory_bundling/test_functions␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    Functions bundling                                            ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    No Functions were found in test_functions directory␊
    ␊
    (Functions bundling completed in 1ms)␊
    Build step duration: Functions bundling completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig.functionsDirectory deletion skips functions bundling

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/functions_directory_skip␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/functions_directory_skip␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/functions_directory_skip/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_directory_skip␊
        publishOrigin: default␊
      functionsDirectory: packages/build/tests/mutate/fixtures/functions_directory_skip/functions␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    packages/build/tests/mutate/fixtures/functions_directory_skip/functions␊
    Netlify configuration property "functions.directory" value changed to ''.␊
    ␊
    > Updated config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_directory_skip␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig.functionsDirectory mutations are used by utils.functions

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/functions_directory_utils␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/functions_directory_utils␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/functions_directory_utils/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_directory_utils␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "functions.directory" value changed to 'test_functions'.␊
    ␊
    > Updated config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_directory_utils␊
        publishOrigin: default␊
      functionsDirectory: packages/build/tests/mutate/fixtures/functions_directory_utils/test_functions␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    ./plugin (onBuild event)                                      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    test␊
    ␊
    (./plugin onBuild completed in 1ms)␊
    Build step duration: ./plugin onBuild completed in 1ms␊
    ␊
    Functions bundling                                            ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Packaging Functions from test_functions directory:␊
     - test.js␊
    ␊
    ␊
    (Functions bundling completed in 1ms)␊
    Build step duration: Functions bundling completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig.functionsDirectory mutations are used by constants.FUNCTIONS_SRC

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/functions_directory_constants␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/functions_directory_constants␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/functions_directory_constants/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_directory_constants␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "functions.directory" value changed to 'test_functions'.␊
    ␊
    > Updated config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_directory_constants␊
        publishOrigin: default␊
      functionsDirectory: packages/build/tests/mutate/fixtures/functions_directory_constants/test_functions␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    ./plugin (onBuild event)                                      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    test_functions␊
    ␊
    (./plugin onBuild completed in 1ms)␊
    Build step duration: ./plugin onBuild completed in 1ms␊
    ␊
    Functions bundling                                            ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    No Functions were found in test_functions directory␊
    ␊
    (Functions bundling completed in 1ms)␊
    Build step duration: Functions bundling completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig.functionsDirectory mutations are taken into account by default constants.FUNCTIONS_SRC

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/functions_directory_default␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/functions_directory_default␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/functions_directory_default/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_directory_default␊
        publishOrigin: default␊
      functionsDirectory: packages/build/tests/mutate/fixtures/functions_directory_default/netlify/functions␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    netlify/functions␊
    Netlify configuration property "functions.directory" value changed to 'test_functions'.␊
    ␊
    > Updated config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_directory_default␊
        publishOrigin: default␊
      functionsDirectory: packages/build/tests/mutate/fixtures/functions_directory_default/test_functions␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    ./plugin (onBuild event)                                      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    test_functions␊
    Netlify configuration property "functions.directory" value changed to ''.␊
    ␊
    > Updated config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_directory_default␊
        publishOrigin: default␊
      functionsDirectory: packages/build/tests/mutate/fixtures/functions_directory_default/netlify/functions␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onBuild completed in 1ms)␊
    Build step duration: ./plugin onBuild completed in 1ms␊
    ␊
    Functions bundling                                            ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    No Functions were found in netlify/functions directory␊
    ␊
    (Functions bundling completed in 1ms)␊
    Build step duration: Functions bundling completed in 1ms␊
    ␊
    ./plugin (onPostBuild event)                                  ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    netlify/functions␊
    ␊
    (./plugin onPostBuild completed in 1ms)␊
    Build step duration: ./plugin onPostBuild completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig.functions.star.directory mutations work

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/functions_directory_star␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/functions_directory_star␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/functions_directory_star/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_directory_star␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "functions.*.directory" value changed to 'test_functions'.␊
    ␊
    > Updated config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_directory_star␊
        publishOrigin: default␊
      functionsDirectory: packages/build/tests/mutate/fixtures/functions_directory_star/test_functions␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    ./plugin (onBuild event)                                      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    packages/build/tests/mutate/fixtures/functions_directory_star/test_functions␊
    ␊
    (./plugin onBuild completed in 1ms)␊
    Build step duration: ./plugin onBuild completed in 1ms␊
    ␊
    Functions bundling                                            ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    No Functions were found in test_functions directory␊
    ␊
    (Functions bundling completed in 1ms)␊
    Build step duration: Functions bundling completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig.functions.star.directory has priority over functions.directory

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/functions_directory_star_priority␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/functions_directory_star_priority␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/functions_directory_star_priority/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_directory_star_priority␊
        publishOrigin: default␊
      functionsDirectory: packages/build/tests/mutate/fixtures/functions_directory_star_priority/one␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "functions.*.directory" value changed to 'test_functions'.␊
    ␊
    > Updated config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_directory_star_priority␊
        publishOrigin: default␊
      functionsDirectory: packages/build/tests/mutate/fixtures/functions_directory_star_priority/test_functions␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    ./plugin (onBuild event)                                      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    packages/build/tests/mutate/fixtures/functions_directory_star_priority/test_functions␊
    ␊
    (./plugin onBuild completed in 1ms)␊
    Build step duration: ./plugin onBuild completed in 1ms␊
    ␊
    Functions bundling                                            ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    No Functions were found in test_functions directory␊
    ␊
    (Functions bundling completed in 1ms)␊
    Build step duration: Functions bundling completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig.functions.directory mutations work

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/functions_directory_nested␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/functions_directory_nested␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/functions_directory_nested/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_directory_nested␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "functions.directory" value changed to 'test_functions'.␊
    ␊
    > Updated config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_directory_nested␊
        publishOrigin: default␊
      functionsDirectory: packages/build/tests/mutate/fixtures/functions_directory_nested/test_functions␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    ./plugin (onBuild event)                                      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    packages/build/tests/mutate/fixtures/functions_directory_nested/test_functions␊
    ␊
    (./plugin onBuild completed in 1ms)␊
    Build step duration: ./plugin onBuild completed in 1ms␊
    ␊
    Functions bundling                                            ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    No Functions were found in test_functions directory␊
    ␊
    (Functions bundling completed in 1ms)␊
    Build step duration: Functions bundling completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig.functions.directory has priority over functions.star.directory

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/functions_directory_nested_priority␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/functions_directory_nested_priority␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/functions_directory_nested_priority/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_directory_nested_priority␊
        publishOrigin: default␊
      functionsDirectory: packages/build/tests/mutate/fixtures/functions_directory_nested_priority/one␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "functions.directory" value changed to 'test_functions'.␊
    ␊
    > Updated config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_directory_nested_priority␊
        publishOrigin: default␊
      functionsDirectory: packages/build/tests/mutate/fixtures/functions_directory_nested_priority/test_functions␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    ./plugin (onBuild event)                                      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    packages/build/tests/mutate/fixtures/functions_directory_nested_priority/test_functions␊
    ␊
    (./plugin onBuild completed in 1ms)␊
    Build step duration: ./plugin onBuild completed in 1ms␊
    ␊
    Functions bundling                                            ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    No Functions were found in test_functions directory␊
    ␊
    (Functions bundling completed in 1ms)␊
    Build step duration: Functions bundling completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig.build.functions mutations work

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/functions_directory_build␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/functions_directory_build␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/functions_directory_build/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_directory_build␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "build.functions" value changed to 'test_functions'.␊
    ␊
    > Updated config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_directory_build␊
        publishOrigin: default␊
      functionsDirectory: packages/build/tests/mutate/fixtures/functions_directory_build/test_functions␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    ./plugin (onBuild event)                                      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    packages/build/tests/mutate/fixtures/functions_directory_build/test_functions␊
    ␊
    (./plugin onBuild completed in 1ms)␊
    Build step duration: ./plugin onBuild completed in 1ms␊
    ␊
    Functions bundling                                            ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    No Functions were found in test_functions directory␊
    ␊
    (Functions bundling completed in 1ms)␊
    Build step duration: Functions bundling completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig.functions mutations are used during functions bundling

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/functions_bundling␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/functions_bundling␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/functions_bundling/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_bundling␊
        publishOrigin: default␊
      functions:␊
        test:␊
          node_bundler: esbuild␊
      functionsDirectory: packages/build/tests/mutate/fixtures/functions_bundling/netlify/functions␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "functions.test.node_bundler" value changed to 'zisi'.␊
    ␊
    > Updated config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_bundling␊
        publishOrigin: default␊
      functions:␊
        test:␊
          node_bundler: zisi␊
      functionsDirectory: packages/build/tests/mutate/fixtures/functions_bundling/netlify/functions␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    Functions bundling                                            ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Packaging Functions from netlify/functions directory:␊
     - test.js␊
    ␊
    ␊
    Dependencies installation error                               ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      A Netlify Function failed to require one of its dependencies.␊
      Please make sure it is present in the site's top-level "package.json".␊
    ␊
      In file "packages/build/tests/mutate/fixtures/functions_bundling/netlify/functions/test.js"␊
      Cannot find module 'does_not_exist'␊
    ␊
      Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_bundling␊
        publishOrigin: default␊
      functions:␊
        test:␊
          node_bundler: zisi␊
      functionsDirectory: packages/build/tests/mutate/fixtures/functions_bundling/netlify/functions␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin`

## netlifyConfig.functions mutations on any property can be used

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/functions_any␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/functions_any␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/functions_any/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_any␊
        publishOrigin: default␊
      functions:␊
        test:␊
          node_bundler: esbuild␊
      functionsDirectory: packages/build/tests/mutate/fixtures/functions_any/netlify/functions␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "functions.test.external_node_modules" value changed to [].␊
    Netlify configuration property "functions.test.ignored_node_modules" value changed to [].␊
    Netlify configuration property "functions.test.included_files" value changed to [].␊
    Netlify configuration property "functions.*.node_bundler" value changed to 'zisi'.␊
    Netlify configuration property "functions.*.external_node_modules" value changed to [].␊
    Netlify configuration property "functions.*.ignored_node_modules" value changed to [].␊
    Netlify configuration property "functions.*.included_files" value changed to [].␊
    Netlify configuration property "functions.node_bundler" value changed to 'zisi'.␊
    Netlify configuration property "functions.external_node_modules" value changed to [ 'test' ].␊
    Netlify configuration property "functions.ignored_node_modules" value changed to [ 'test' ].␊
    Netlify configuration property "functions.included_files" value changed to [ 'test' ].␊
    ␊
    > Updated config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_any␊
        publishOrigin: default␊
      functions:␊
        '*':␊
          external_node_modules:␊
            - test␊
          ignored_node_modules:␊
            - test␊
          included_files:␊
            - test␊
          node_bundler: zisi␊
        test:␊
          external_node_modules: []␊
          ignored_node_modules: []␊
          included_files: []␊
          node_bundler: esbuild␊
      functionsDirectory: packages/build/tests/mutate/fixtures/functions_any/netlify/functions␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    Functions bundling                                            ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    No Functions were found in netlify/functions directory␊
    ␊
    (Functions bundling completed in 1ms)␊
    Build step duration: Functions bundling completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig.functions mutations can add new functions configs

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/functions_new␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/functions_new␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/functions_new/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_new␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "functions.test" value changed to { included_files: [] }.␊
    ␊
    > Updated config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/functions_new␊
        publishOrigin: default␊
      functions:␊
        test:␊
          included_files: []␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig.functions mutations are only logged in debug mode

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: false␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/functions_no_log_debug␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/functions_no_log_debug/netlify.toml␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)`

## netlifyConfig properties are deeply readonly by default

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/readonly_deep␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/readonly_deep␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/readonly_deep/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/readonly_deep␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "plugins" value changed to [␊
      { package: './plugin', origin: 'config', inputs: { example: true } }␊
    ].␊
    ␊
    Plugin "./plugin" internal error                              ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: "netlifyConfig.plugins" is read-only.␊
    ␊
      Plugin details␊
      Package:        ./plugin␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onPreBuild" event in "./plugin" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/readonly_deep␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin`

## netlifyConfig.processing can be assigned all at once

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/processing_all␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/processing_all␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/processing_all/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        processing:␊
          css:␊
            bundle: false␊
            minify: false␊
          html:␊
            pretty_urls: false␊
          images:␊
            compress: false␊
          js:␊
            bundle: false␊
            minify: false␊
          skip_processing: false␊
        publish: packages/build/tests/mutate/fixtures/processing_all␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "build.processing.css.bundle" value changed to true.␊
    Netlify configuration property "build.processing.css.minify" value changed to true.␊
    Netlify configuration property "build.processing.html.pretty_urls" value changed to true.␊
    Netlify configuration property "build.processing.images.compress" value changed to true.␊
    Netlify configuration property "build.processing.js.bundle" value changed to true.␊
    Netlify configuration property "build.processing.js.minify" value changed to true.␊
    Netlify configuration property "build.processing.skip_processing" value changed to true.␊
    ␊
    > Updated config␊
      build:␊
        processing:␊
          css:␊
            bundle: true␊
            minify: true␊
          html:␊
            pretty_urls: true␊
          images:␊
            compress: true␊
          js:␊
            bundle: true␊
            minify: true␊
          skip_processing: true␊
        publish: packages/build/tests/mutate/fixtures/processing_all␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    ./plugin (onBuild event)                                      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    {␊
      css: { bundle: true, minify: true },␊
      html: { pretty_urls: true },␊
      images: { compress: true },␊
      js: { bundle: true, minify: true },␊
      skip_processing: true␊
    }␊
    ␊
    (./plugin onBuild completed in 1ms)␊
    Build step duration: ./plugin onBuild completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig.processing can be assigned individually

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/processing_prop␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/processing_prop␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/processing_prop/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        processing:␊
          css:␊
            bundle: false␊
            minify: false␊
          html:␊
            pretty_urls: false␊
          images:␊
            compress: false␊
          js:␊
            bundle: false␊
            minify: false␊
          skip_processing: false␊
        publish: packages/build/tests/mutate/fixtures/processing_prop␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "build.processing.css.bundle" value changed to true.␊
    Netlify configuration property "build.processing.css.minify" value changed to true.␊
    Netlify configuration property "build.processing.html.pretty_urls" value changed to true.␊
    Netlify configuration property "build.processing.images.compress" value changed to true.␊
    Netlify configuration property "build.processing.js.bundle" value changed to true.␊
    Netlify configuration property "build.processing.js.minify" value changed to true.␊
    Netlify configuration property "build.processing.skip_processing" value changed to true.␊
    ␊
    > Updated config␊
      build:␊
        processing:␊
          css:␊
            bundle: true␊
            minify: true␊
          html:␊
            pretty_urls: true␊
          images:␊
            compress: true␊
          js:␊
            bundle: true␊
            minify: true␊
          skip_processing: true␊
        publish: packages/build/tests/mutate/fixtures/processing_prop␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    ./plugin (onBuild event)                                      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    {␊
      css: { bundle: true, minify: true },␊
      html: { pretty_urls: true },␊
      images: { compress: true },␊
      js: { bundle: true, minify: true },␊
      skip_processing: true␊
    }␊
    ␊
    (./plugin onBuild completed in 1ms)␊
    Build step duration: ./plugin onBuild completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig.build.command can be changed

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/build_command_change␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/build_command_change␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/build_command_change/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        command: test␊
        commandOrigin: config␊
        publish: packages/build/tests/mutate/fixtures/build_command_change␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "build.command" value changed to 'node --version'.␊
    ␊
    > Updated config␊
      build:␊
        command: node --version␊
        commandOrigin: inline␊
        publish: packages/build/tests/mutate/fixtures/build_command_change␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    build.command from a plugin                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    $ node --version␊
    v1.0.0␊
    ␊
    (build.command completed in 1ms)␊
    Build step duration: build.command completed in 1ms␊
    ␊
    ./plugin (onBuild event)                                      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    node --version␊
    ␊
    (./plugin onBuild completed in 1ms)␊
    Build step duration: ./plugin onBuild completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig.build.command can be added

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/build_command_add␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/build_command_add␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/build_command_add/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/build_command_add␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "build.command" value changed to 'node --version'.␊
    ␊
    > Updated config␊
      build:␊
        command: node --version␊
        commandOrigin: inline␊
        publish: packages/build/tests/mutate/fixtures/build_command_add␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    build.command from a plugin                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    $ node --version␊
    v1.0.0␊
    ␊
    (build.command completed in 1ms)␊
    Build step duration: build.command completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig.build.command can be removed

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/build_command_remove␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/build_command_remove␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/build_command_remove/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        command: test␊
        commandOrigin: config␊
        publish: packages/build/tests/mutate/fixtures/build_command_remove␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "build.command" value changed to ''.␊
    ␊
    > Updated config␊
      build:␊
        commandOrigin: config␊
        publish: packages/build/tests/mutate/fixtures/build_command_remove␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig.build.environment can be assigned all at once

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/env_all␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/env_all␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/env_all/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        environment:␊
          - TEST_ONE␊
        publish: packages/build/tests/mutate/fixtures/env_all␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "build.environment.TEST_TWO" value changed.␊
    ␊
    > Updated config␊
      build:␊
        environment:␊
          - TEST_ONE␊
          - TEST_TWO␊
        publish: packages/build/tests/mutate/fixtures/env_all␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    ./plugin (onBuild event)                                      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    { TEST_ONE: 'one', TEST_TWO: 'two' }␊
    ␊
    (./plugin onBuild completed in 1ms)␊
    Build step duration: ./plugin onBuild completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig.build.environment can be assigned individually

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/env_prop␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/env_prop␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/env_prop/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        environment:␊
          - TEST_ONE␊
        publish: packages/build/tests/mutate/fixtures/env_prop␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "build.environment.TEST_TWO" value changed.␊
    ␊
    > Updated config␊
      build:␊
        environment:␊
          - TEST_ONE␊
          - TEST_TWO␊
        publish: packages/build/tests/mutate/fixtures/env_prop␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    ./plugin (onBuild event)                                      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    { TEST_ONE: 'one', TEST_TWO: 'two' }␊
    ␊
    (./plugin onBuild completed in 1ms)␊
    Build step duration: ./plugin onBuild completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig.build.publish mutations are used by constants.PUBLISH_DIR

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/publish_constants␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/publish_constants␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/publish_constants/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/publish_constants␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    .␊
    Netlify configuration property "build.publish" value changed to 'test'.␊
    ␊
    > Updated config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/publish_constants/test␊
        publishOrigin: inline␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    ./plugin (onBuild event)                                      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    test␊
    ␊
    (./plugin onBuild completed in 1ms)␊
    Build step duration: ./plugin onBuild completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig.build.edge_functions mutations are used by constants.EDGE_FUNCTIONS_SRC

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: false␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/edge_functions_constants␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/edge_functions_constants/netlify.toml␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    true␊
    Netlify configuration property "build.edge_functions" value changed to 'test'.␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    ␊
    ./plugin (onBuild event)                                      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    test␊
    ␊
    (./plugin onBuild completed in 1ms)␊
    ␊
    Edge Functions bundling                                       ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    No Edge Functions were found in test directory␊
    ␊
    (Edge Functions bundling completed in 1ms)␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)`

## netlifyConfig.edge_functions can be assigned all at once

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: false␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/edge_functions_all␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/edge_functions_all/netlify.toml␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "edge_functions" value changed to [ { path: '/external/path', function: 'two' } ].␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    ␊
    ./plugin (onBuild event)                                      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    [ { path: '/external/path', function: 'two' } ]␊
    ␊
    (./plugin onBuild completed in 1ms)␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)`

## netlifyConfig.services can be assigned all at once

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/services_all␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/services_all␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/services_all/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/services_all␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "build.services.identity" value changed to 'two'.␊
    ␊
    > Updated config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/services_all␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    ./plugin (onBuild event)                                      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    { identity: 'two' }␊
    ␊
    (./plugin onBuild completed in 1ms)␊
    Build step duration: ./plugin onBuild completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig.services can be assigned individually

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/services_prop␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/services_prop␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/services_prop/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/services_prop␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "build.services.identity" value changed to 'two'.␊
    ␊
    > Updated config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/services_prop␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    ./plugin (onBuild event)                                      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    { identity: 'two' }␊
    ␊
    (./plugin onBuild completed in 1ms)␊
    Build step duration: ./plugin onBuild completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig mutations fail if done in an event that is too late

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/too_late␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/too_late␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/too_late/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/too_late␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onBuild event)                                      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "build.command" value changed to 'node --version'.␊
    ␊
    Plugin "./plugin" internal error                              ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: "netlifyConfig.build.command" cannot be modified after "onPreBuild".␊
    ␊
      Plugin details␊
      Package:        ./plugin␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onBuild" event in "./plugin" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/too_late␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin`

## netlifyConfig mutations fail correctly on symbols

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/symbol␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/symbol␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/symbol/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        command: node --version␊
        commandOrigin: config␊
        publish: packages/build/tests/mutate/fixtures/symbol␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    (./plugin onPreBuild completed in 1ms)␊
    Build step duration: ./plugin onPreBuild completed in 1ms␊
    ␊
    build.command from netlify.toml                               ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    $ node --version␊
    v1.0.0␊
    ␊
    (build.command completed in 1ms)␊
    Build step duration: build.command completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## netlifyConfig mutations fail if the syntax is invalid

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/mutate/fixtures/invalid_syntax␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/mutate/fixtures/invalid_syntax␊
    ␊
    > Config file␊
      packages/build/tests/mutate/fixtures/invalid_syntax/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/invalid_syntax␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin@1.0.0 from netlify.toml␊
    ␊
    ./plugin (onPreBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Netlify configuration property "build.command" value changed to false.␊
    ␊
    Plugin "./plugin" internal error                              ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: When resolving config file packages/build/tests/mutate/fixtures/invalid_syntax/netlify.toml:␊
      Configuration property build.command must be a string␊
    ␊
      Invalid syntax␊
    ␊
        [build]␊
        command = false␊
    ␊
      Valid syntax␊
    ␊
        [build]␊
        command = "npm run build"␊
    ␊
      Plugin details␊
      Package:        ./plugin␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onPreBuild" event in "./plugin" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        publish: packages/build/tests/mutate/fixtures/invalid_syntax␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin`
