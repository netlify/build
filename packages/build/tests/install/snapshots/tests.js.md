# Snapshot report for `packages/build/tests/install/tests.js`

The actual snapshot is saved in `tests.js.snap`.

Generated by [AVA](https://ava.li).

## Automatically install missing plugins in CI

> Snapshot 1

    `␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      buildImagePluginsDir: /file/path␊
      debug: true␊
      featureFlags: {}␊
      repositoryRoot: /file/path␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      /file/path␊
    ␊
    > Config file␊
      /file/path␊
    ␊
    > Resolved config␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: netlify-plugin-contextual-env␊
    ␊
    > Context␊
      production␊
    ␊
    > Installing plugins␊
       - netlify-plugin-contextual-env@latest␊
    ␊
    > Missing plugins␊
      Please install the following plugins using "npm install -D netlify-plugin-package-name" or "yarn add -D netlify-plugin-package-name"␊
       - netlify-plugin-contextual-env␊
    ␊
    > Loading plugins␊
       - netlify-plugin-contextual-env@1.0.0 from netlify.toml␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      1. onPreBuild command from netlify-plugin-contextual-env      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Nothing found... keeping default ENVs␊
    ␊
    (netlify-plugin-contextual-env onPreBuild completed in 1ms)␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)`

## Automatically install missing plugins locally

> Snapshot 1

    `␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      featureFlags: {}␊
      repositoryRoot: /file/path␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      /file/path␊
    ␊
    > Config file␊
      /file/path␊
    ␊
    > Resolved config␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: netlify-plugin-contextual-env␊
    ␊
    > Context␊
      production␊
    ␊
    > Installing plugins␊
       - netlify-plugin-contextual-env@latest␊
    ␊
    > Missing plugins␊
      Please install the following plugins using "npm install -D netlify-plugin-package-name" or "yarn add -D netlify-plugin-package-name"␊
       - netlify-plugin-contextual-env␊
    ␊
    > Loading plugins␊
       - netlify-plugin-contextual-env@1.0.0 from netlify.toml␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      1. onPreBuild command from netlify-plugin-contextual-env      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Nothing found... keeping default ENVs␊
    ␊
    (netlify-plugin-contextual-env onPreBuild completed in 1ms)␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)`

## Automatically install missing plugins locally when picked in UI

> Snapshot 1

    `␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      featureFlags: {}␊
      mode: buildbot␊
      repositoryRoot: /file/path␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      /file/path␊
    ␊
    > Config file␊
      No config file was defined: using default values.␊
    ␊
    > Resolved config␊
      plugins:␊
        - inputs: {}␊
          origin: ui␊
          package: netlify-plugin-contextual-env␊
    ␊
    > Context␊
      production␊
    ␊
    > Installing plugins␊
       - netlify-plugin-contextual-env@latest␊
    ␊
    > Loading plugins␊
       - netlify-plugin-contextual-env@1.0.0 from Netlify app␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      1. onPreBuild command from netlify-plugin-contextual-env      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Nothing found... keeping default ENVs␊
    ␊
    (netlify-plugin-contextual-env onPreBuild completed in 1ms)␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)`

## Functions: does not install dependencies unless opting in

> Snapshot 1

    `␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      featureFlags: {}␊
      repositoryRoot: /file/path␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      /file/path␊
    ␊
    > Config file␊
      /file/path␊
    ␊
    > Resolved config␊
      build:␊
        functions: /file/path␊
    ␊
    > Context␊
      production␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      1. Functions bundling                                         ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Packaging Functions from functions directory:␊
     - index.js␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      Dependencies installation error                               ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      A Netlify Function is using "math-avg" but that dependency has not been installed yet.␊
    ␊
      By default, dependencies inside a Netlify Function's "package.json" are not automatically installed.␊
      There are several ways to fix this problem:␊
        - Removing your Function's "package.json" and adding the dependencies to the project's top-level "package.json" instead. This is the fastest and safest solution.␊
        - Running "npm install" or "yarn" inside your Netlify Function in your build command.␊
        - Adding the following plugin to your "netlify.toml":␊
    ␊
      [[plugins]]␊
      package = "@netlify/plugin-functions-install-core"␊
    ␊
      In file "/file/path"␊
    ␊
    ␊
      Resolved config␊
      build:␊
        functions: /file/path`

## Functions: does not print warnings when dependency was local

> Snapshot 1

    `␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      featureFlags: {}␊
      repositoryRoot: /file/path␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      /file/path␊
    ␊
    > Config file␊
      /file/path␊
    ␊
    > Resolved config␊
      build:␊
        functions: /file/path␊
    ␊
    > Context␊
      production␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      1. Functions bundling                                         ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Packaging Functions from functions directory:␊
     - index.js␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      Dependencies installation error                               ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      A Netlify Function failed to require one of its dependencies.␊
      If the dependency is a Node module, please make sure it is present in the site's top-level "package.json".␊
      If it is a local file instead, please make sure the file exists and its filename is correctly spelled.␊
    ␊
      In file "/file/path"␊
    ␊
    ␊
      Resolved config␊
      build:␊
        functions: /file/path`

## Functions: does not print warnings when dependency was mispelled

> Snapshot 1

    `␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      featureFlags: {}␊
      repositoryRoot: /file/path␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      /file/path␊
    ␊
    > Config file␊
      /file/path␊
    ␊
    > Resolved config␊
      build:␊
        functions: /file/path␊
    ␊
    > Context␊
      production␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      1. Functions bundling                                         ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Packaging Functions from functions directory:␊
     - index.js␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      Dependencies installation error                               ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      A Netlify Function failed to require one of its dependencies.␊
      If the dependency is a Node module, please make sure it is present in the site's top-level "package.json".␊
      If it is a local file instead, please make sure the file exists and its filename is correctly spelled.␊
    ␊
      In file "/file/path"␊
    ␊
    ␊
      Resolved config␊
      build:␊
        functions: /file/path`

## Functions: ignore package.json inside node_modules

> Snapshot 1

    `␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      featureFlags: {}␊
      repositoryRoot: /file/path␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      /file/path␊
    ␊
    > Config file␊
      /file/path␊
    ␊
    > Resolved config␊
      build:␊
        functions: /file/path␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: '@netlify/plugin-functions-install-core'␊
    ␊
    > Context␊
      production␊
    ␊
    ─────────────────────────────────────────────────────────────────────␊
      1. onPreBuild command from @netlify/plugin-functions-install-core  ␊
    ─────────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    (@netlify/plugin-functions-install-core onPreBuild completed in 1ms)␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      2. Functions bundling                                         ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Packaging Functions from functions directory:␊
     - test.js␊
    ␊
    (Functions bundling completed in 1ms)␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)`

## Functions: install dependencies handles errors

> Snapshot 1

    `␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      featureFlags: {}␊
      repositoryRoot: /file/path␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      /file/path␊
    ␊
    > Config file␊
      /file/path␊
    ␊
    > Resolved config␊
      build:␊
        functions: /file/path␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: '@netlify/plugin-functions-install-core'␊
    ␊
    > Context␊
      production␊
    ␊
    ─────────────────────────────────────────────────────────────────────␊
      1. onPreBuild command from @netlify/plugin-functions-install-core  ␊
    ─────────────────────────────────────────────────────────────────────␊
    ␊
    Installing functions dependencies␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      Dependencies installation error                               ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error while installing dependencies in /file/path␊
      npm ERR! code E404␊
    ␊
    ␊
      Plugin details␊
      Package:        @netlify/plugin-functions-install-core␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      npm link:       https://www.npmjs.com/package/@netlify/build␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Resolved config␊
      build:␊
        functions: /file/path␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: '@netlify/plugin-functions-install-core'`

## Functions: install dependencies nested

> Snapshot 1

    `␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      featureFlags: {}␊
      repositoryRoot: /file/path␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      /file/path␊
    ␊
    > Config file␊
      /file/path␊
    ␊
    > Resolved config␊
      build:␊
        functions: /file/path␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: '@netlify/plugin-functions-install-core'␊
    ␊
    > Context␊
      production␊
    ␊
    ─────────────────────────────────────────────────────────────────────␊
      1. onPreBuild command from @netlify/plugin-functions-install-core  ␊
    ─────────────────────────────────────────────────────────────────────␊
    ␊
    Installing functions dependencies␊
    ␊
    (@netlify/plugin-functions-install-core onPreBuild completed in 1ms)␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      2. Functions bundling                                         ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Packaging Functions from functions directory:␊
     - function/index.js␊
    ␊
    (Functions bundling completed in 1ms)␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)`

## Functions: install dependencies with Yarn in CI

> Snapshot 1

    `␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      deployId: functions_yarn_ci␊
      featureFlags: {}␊
      mode: buildbot␊
      repositoryRoot: /file/path␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: 'true'␊
    ␊
    > Current directory␊
      /file/path␊
    ␊
    > Config file␊
      /file/path␊
    ␊
    > Resolved config␊
      build:␊
        functions: /file/path␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: '@netlify/plugin-functions-install-core'␊
    ␊
    > Context␊
      production␊
    ␊
    ─────────────────────────────────────────────────────────────────────␊
      1. onPreBuild command from @netlify/plugin-functions-install-core  ␊
    ─────────────────────────────────────────────────────────────────────␊
    ␊
    Installing functions dependencies␊
    ␊
    (@netlify/plugin-functions-install-core onPreBuild completed in 1ms)␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      2. Functions bundling                                         ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Packaging Functions from functions directory:␊
     - index.js␊
    ␊
    (Functions bundling completed in 1ms)␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)`

## Functions: install dependencies with Yarn locally

> Snapshot 1

    `␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      featureFlags: {}␊
      repositoryRoot: /file/path␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: 'true'␊
    ␊
    > Current directory␊
      /file/path␊
    ␊
    > Config file␊
      /file/path␊
    ␊
    > Resolved config␊
      build:␊
        functions: /file/path␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: '@netlify/plugin-functions-install-core'␊
    ␊
    > Context␊
      production␊
    ␊
    ─────────────────────────────────────────────────────────────────────␊
      1. onPreBuild command from @netlify/plugin-functions-install-core  ␊
    ─────────────────────────────────────────────────────────────────────␊
    ␊
    Installing functions dependencies␊
    ␊
    (@netlify/plugin-functions-install-core onPreBuild completed in 1ms)␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      2. Functions bundling                                         ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Packaging Functions from functions directory:␊
     - index.js␊
    ␊
    (Functions bundling completed in 1ms)␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)`

## Functions: install dependencies with npm

> Snapshot 1

    `␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      featureFlags: {}␊
      repositoryRoot: /file/path␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      /file/path␊
    ␊
    > Config file␊
      /file/path␊
    ␊
    > Resolved config␊
      build:␊
        functions: /file/path␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: '@netlify/plugin-functions-install-core'␊
    ␊
    > Context␊
      production␊
    ␊
    ─────────────────────────────────────────────────────────────────────␊
      1. onPreBuild command from @netlify/plugin-functions-install-core  ␊
    ─────────────────────────────────────────────────────────────────────␊
    ␊
    Installing functions dependencies␊
    ␊
    (@netlify/plugin-functions-install-core onPreBuild completed in 1ms)␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      2. Functions bundling                                         ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Packaging Functions from functions directory:␊
     - index.js␊
    ␊
    (Functions bundling completed in 1ms)␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)`

## Install local plugin dependencies: already installed

> Snapshot 1

    `␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      featureFlags: {}␊
      repositoryRoot: /file/path␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      /file/path␊
    ␊
    > Config file␊
      /file/path␊
    ␊
    > Resolved config␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: '@netlify/plugin-local-install-core'␊
        - inputs: {}␊
          origin: config␊
          package: /file/path␊
    ␊
    > Context␊
      production␊
    ␊
    > Installing local plugins dependencies␊
       - /file/path␊
    ␊
    > Loading plugins␊
       - /file/path from netlify.toml␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      1. onPreBuild command from /file/path                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    1.5␊
    ␊
    (/file/path onPreBuild completed in 1ms)␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)`

## Install local plugin dependencies: missing plugin in netlify.toml

> Snapshot 1

    `␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      featureFlags: {}␊
      repositoryRoot: /file/path␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      /file/path␊
    ␊
    > Config file␊
      /file/path␊
    ␊
    > Resolved config␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: /file/path␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - /file/path from netlify.toml␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      Plugin "/file/path" internal error                      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: Could not import plugin:␊
    ␊
    ␊
      Plugin details␊
      Package:        /file/path␊
      Version:        1.0.0␊
      Repository:     test␊
    ␊
      Error location␊
      While loading "/file/path" from netlify.toml␊
    STACK TRACE␊
    ␊
      Error properties␊
      { code: 'MODULE_NOT_FOUND' }␊
    ␊
      Resolved config␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: /file/path`

## Install local plugin dependencies: no package.json

> Snapshot 1

    `␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      featureFlags: {}␊
      repositoryRoot: /file/path␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      /file/path␊
    ␊
    > Config file␊
      /file/path␊
    ␊
    > Resolved config␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: '@netlify/plugin-local-install-core'␊
        - inputs: {}␊
          origin: config␊
          package: /file/path␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - /file/path from netlify.toml␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      Plugin "/file/path" internal error                      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: Could not import plugin:␊
    ␊
    ␊
      Plugin details␊
      Package:        /file/path␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      While loading "/file/path" from netlify.toml␊
    STACK TRACE␊
    ␊
      Error properties␊
      { code: 'MODULE_NOT_FOUND' }␊
    ␊
      Resolved config␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: '@netlify/plugin-local-install-core'␊
        - inputs: {}␊
          origin: config␊
          package: /file/path`

## Install local plugin dependencies: no root package.json

> Snapshot 1

    `␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      featureFlags: {}␊
      repositoryRoot: /file/path␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      /file/path␊
    ␊
    > Config file␊
      /file/path␊
    ␊
    > Resolved config␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: '@netlify/plugin-local-install-core'␊
        - inputs: {}␊
          origin: config␊
          package: /file/path␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - /file/path from netlify.toml␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      1. onPreBuild command from /file/path                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    test␊
    ␊
    (/file/path onPreBuild completed in 1ms)␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)`

## Install local plugin dependencies: propagate errors

> Snapshot 1

    `␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      featureFlags: {}␊
      repositoryRoot: /file/path␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      /file/path␊
    ␊
    > Config file␊
      /file/path␊
    ␊
    > Resolved config␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: '@netlify/plugin-local-install-core'␊
        - inputs: {}␊
          origin: config␊
          package: /file/path␊
    ␊
    > Context␊
      production␊
    ␊
    > Installing local plugins dependencies␊
       - /file/path␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      Dependencies installation error                               ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error while installing dependencies in /file/path␊
      npm ERR! code E404␊
    ␊
    ␊
      Resolved config␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: '@netlify/plugin-local-install-core'␊
        - inputs: {}␊
          origin: config␊
          package: /file/path`

## Install local plugin dependencies: with npm

> Snapshot 1

    `␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      featureFlags: {}␊
      repositoryRoot: /file/path␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      /file/path␊
    ␊
    > Config file␊
      /file/path␊
    ␊
    > Resolved config␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: '@netlify/plugin-local-install-core'␊
        - inputs: {}␊
          origin: config␊
          package: /file/path␊
    ␊
    > Context␊
      production␊
    ␊
    > Installing local plugins dependencies␊
       - /file/path␊
    ␊
    > Loading plugins␊
       - /file/path from netlify.toml␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      1. onPreBuild command from /file/path                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    1.5␊
    ␊
    (/file/path onPreBuild completed in 1ms)␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)`

## Install local plugin dependencies: with yarn in CI

> Snapshot 1

    `␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      featureFlags: {}␊
      mode: buildbot␊
      repositoryRoot: /file/path␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: 'true'␊
    ␊
    > Current directory␊
      /file/path␊
    ␊
    > Config file␊
      /file/path␊
    ␊
    > Resolved config␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: '@netlify/plugin-local-install-core'␊
        - inputs: {}␊
          origin: config␊
          package: /file/path␊
    ␊
    > Context␊
      production␊
    ␊
    > Installing local plugins dependencies␊
       - /file/path␊
    ␊
    > Loading plugins␊
       - /file/path from netlify.toml␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      1. onPreBuild command from /file/path                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    1.5␊
    ␊
    (/file/path onPreBuild completed in 1ms)␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)`

## Install local plugin dependencies: with yarn locally

> Snapshot 1

    `␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      featureFlags: {}␊
      repositoryRoot: /file/path␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: 'true'␊
    ␊
    > Current directory␊
      /file/path␊
    ␊
    > Config file␊
      /file/path␊
    ␊
    > Resolved config␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: '@netlify/plugin-local-install-core'␊
        - inputs: {}␊
          origin: config␊
          package: /file/path␊
    ␊
    > Context␊
      production␊
    ␊
    > Installing local plugins dependencies␊
       - /file/path␊
    ␊
    > Loading plugins␊
       - /file/path from netlify.toml␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      1. onPreBuild command from /file/path                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    1.5␊
    ␊
    (/file/path onPreBuild completed in 1ms)␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)`

## Re-use previously automatically installed plugins

> Snapshot 1

    `␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      featureFlags: {}␊
      repositoryRoot: /file/path␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      /file/path␊
    ␊
    > Config file␊
      /file/path␊
    ␊
    > Resolved config␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: netlify-plugin-contextual-env␊
    ␊
    > Context␊
      production␊
    ␊
    > Installing plugins␊
       - netlify-plugin-contextual-env@latest␊
    ␊
    > Missing plugins␊
      Please install the following plugins using "npm install -D netlify-plugin-package-name" or "yarn add -D netlify-plugin-package-name"␊
       - netlify-plugin-contextual-env␊
    ␊
    > Loading plugins␊
       - netlify-plugin-contextual-env@1.0.0 from netlify.toml␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      1. onPreBuild command from netlify-plugin-contextual-env      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Nothing found... keeping default ENVs␊
    ␊
    (netlify-plugin-contextual-env onPreBuild completed in 1ms)␊
    ␊
    ────────────────────────────────────────────────────────────────␊
      Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)`
