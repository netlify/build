# Snapshot report for `packages/build/tests/blobs_upload/tests.js`

The actual snapshot is saved in `tests.js.snap`.

Generated by [AVA](https://avajs.dev).

## blobs upload, don't run when deploy id is provided and no files in directory

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      deployId: abc123␊
      repositoryRoot: packages/build/tests/blobs_upload/fixtures/src_empty␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/blobs_upload/fixtures/src_empty␊
    ␊
    > Config file␊
      packages/build/tests/blobs_upload/fixtures/src_empty/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        base: packages/build/tests/blobs_upload/fixtures/src_empty␊
        publish: packages/build/tests/blobs_upload/fixtures/src_empty␊
        publishOrigin: config␊
    ␊
    > Context␊
      production␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## blobs upload, don't run when there are files but deploy id is not provided

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/blobs_upload/fixtures/src_with_blobs␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/blobs_upload/fixtures/src_with_blobs␊
    ␊
    > Config file␊
      packages/build/tests/blobs_upload/fixtures/src_with_blobs/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        base: packages/build/tests/blobs_upload/fixtures/src_with_blobs␊
        publish: packages/build/tests/blobs_upload/fixtures/src_with_blobs/dist␊
        publishOrigin: config␊
    ␊
    > Context␊
      production␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## blobs upload, uploads files to deploy store

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      deployId: abc123␊
      repositoryRoot: packages/build/tests/blobs_upload/fixtures/src_with_blobs␊
      siteId: test␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/blobs_upload/fixtures/src_with_blobs␊
    ␊
    > Config file␊
      packages/build/tests/blobs_upload/fixtures/src_with_blobs/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        base: packages/build/tests/blobs_upload/fixtures/src_with_blobs␊
        publish: packages/build/tests/blobs_upload/fixtures/src_with_blobs/dist␊
        publishOrigin: config␊
    ␊
    > Context␊
      production␊
    ␊
    Uploading blobs to deploy store                               ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Uploading 3 blobs to deploy store...␊
      - Uploading blob something.txt␊
      - Uploading blob with-metadata.txt␊
      - Uploading blob nested/file.txt␊
    Done uploading blobs to deploy store.␊
    ␊
    (Uploading blobs completed in 1ms)␊
    Build step duration: Uploading blobs completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## blobs upload, cancels deploy if blob metadata is malformed

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      deployId: abc123␊
      repositoryRoot: packages/build/tests/blobs_upload/fixtures/src_with_malformed_blobs_metadata␊
      siteId: test␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/blobs_upload/fixtures/src_with_malformed_blobs_metadata␊
    ␊
    > Config file␊
      packages/build/tests/blobs_upload/fixtures/src_with_malformed_blobs_metadata/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        base: packages/build/tests/blobs_upload/fixtures/src_with_malformed_blobs_metadata␊
        publish: packages/build/tests/blobs_upload/fixtures/src_with_malformed_blobs_metadata/dist␊
        publishOrigin: config␊
    ␊
    > Context␊
      production␊
    ␊
    Uploading blobs to deploy store                               ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    Uploading 1 blobs to deploy store...␊
      - Uploading blob with-metadata.txt␊
    Error uploading blobs to deploy store: Failed while reading 'with-metadata.txt' and its metadata: Unexpected token T in JSON at position 0␊
    ␊
    Core internal error                                           ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: Failed while uploading blobs to deploy store.␊
    ␊
      Error location␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        base: packages/build/tests/blobs_upload/fixtures/src_with_malformed_blobs_metadata␊
        publish: packages/build/tests/blobs_upload/fixtures/src_with_malformed_blobs_metadata/dist␊
        publishOrigin: config`
