# Snapshot report for `tests/plugins_events/tests.js`

The actual snapshot is saved in `tests.js.snap`.

Generated by [AVA](https://avajs.dev).

## plugin.onSuccess is triggered on success

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/plugins_events/fixtures/success_ok␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/plugins_events/fixtures/success_ok␊
    ␊
    > Config file␊
      packages/build/tests/plugins_events/fixtures/success_ok/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/success_ok␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onBuild␊
    ␊
    (./plugin.js onBuild completed in 1ms)␊
    Build step duration: ./plugin.js onBuild completed in 1ms␊
    ␊
    ./plugin.js (onSuccess event)                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onSuccess␊
    ␊
    (./plugin.js onSuccess completed in 1ms)␊
    Build step duration: ./plugin.js onSuccess completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## plugin.onSuccess is not triggered on failure

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/plugins_events/fixtures/success_not_ok␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/plugins_events/fixtures/success_not_ok␊
    ␊
    > Config file␊
      packages/build/tests/plugins_events/fixtures/success_not_ok/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/success_not_ok␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    Plugin "./plugin.js" internal error                           ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: onBuild␊
    ␊
      Plugin details␊
      Package:        ./plugin.js␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onBuild" event in "./plugin.js" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/success_not_ok␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js`

## plugin.onSuccess is not triggered on failPlugin()

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/plugins_events/fixtures/success_fail_plugin␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/plugins_events/fixtures/success_fail_plugin␊
    ␊
    > Config file␊
      packages/build/tests/plugins_events/fixtures/success_fail_plugin/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/success_fail_plugin␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    Plugin "./plugin.js" failed                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: onBuild␊
    ␊
      Plugin details␊
      Package:        ./plugin.js␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onBuild" event in "./plugin.js" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/success_fail_plugin␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## plugin.onSuccess is not triggered on cancelBuild()

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/plugins_events/fixtures/success_cancel_build␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/plugins_events/fixtures/success_cancel_build␊
    ␊
    > Config file␊
      packages/build/tests/plugins_events/fixtures/success_cancel_build/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/success_cancel_build␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    Build canceled by ./plugin.js                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      onBuild␊
    `

## plugin.onSuccess can fail but does not stop builds

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/plugins_events/fixtures/success_fail␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/plugins_events/fixtures/success_fail␊
    ␊
    > Config file␊
      packages/build/tests/plugins_events/fixtures/success_fail/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/success_fail␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onBuild␊
    ␊
    (./plugin.js onBuild completed in 1ms)␊
    Build step duration: ./plugin.js onBuild completed in 1ms␊
    ␊
    ./plugin.js (onSuccess event)                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    Plugin "./plugin.js" internal error                           ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: onSuccess␊
    ␊
      Plugin details␊
      Package:        ./plugin.js␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onSuccess" event in "./plugin.js" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/success_fail␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## plugin.onError is not triggered on success

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/plugins_events/fixtures/error_ok␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/plugins_events/fixtures/error_ok␊
    ␊
    > Config file␊
      packages/build/tests/plugins_events/fixtures/error_ok/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/error_ok␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onBuild␊
    ␊
    (./plugin.js onBuild completed in 1ms)␊
    Build step duration: ./plugin.js onBuild completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## plugin.onError is triggered on failure

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/plugins_events/fixtures/error_not_ok␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/plugins_events/fixtures/error_not_ok␊
    ␊
    > Config file␊
      packages/build/tests/plugins_events/fixtures/error_not_ok/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/error_not_ok␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    ./plugin.js (onError event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onError␊
    ␊
    (./plugin.js onError completed in 1ms)␊
    Build step duration: ./plugin.js onError completed in 1ms␊
    ␊
    Plugin "./plugin.js" internal error                           ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: onBuild␊
    ␊
      Plugin details␊
      Package:        ./plugin.js␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onBuild" event in "./plugin.js" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/error_not_ok␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js`

## plugin.onError is not triggered on failPlugin()

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/plugins_events/fixtures/error_fail_plugin␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/plugins_events/fixtures/error_fail_plugin␊
    ␊
    > Config file␊
      packages/build/tests/plugins_events/fixtures/error_fail_plugin/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/error_fail_plugin␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    Plugin "./plugin.js" failed                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: onBuild␊
    ␊
      Plugin details␊
      Package:        ./plugin.js␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onBuild" event in "./plugin.js" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/error_fail_plugin␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## plugin.onError is triggered on cancelBuild()

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/plugins_events/fixtures/error_cancel_build␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/plugins_events/fixtures/error_cancel_build␊
    ␊
    > Config file␊
      packages/build/tests/plugins_events/fixtures/error_cancel_build/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/error_cancel_build␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    ./plugin.js (onError event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onError␊
    ␊
    (./plugin.js onError completed in 1ms)␊
    Build step duration: ./plugin.js onError completed in 1ms␊
    ␊
    Build canceled by ./plugin.js                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      onBuild␊
    `

## plugin.onError can fail

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/plugins_events/fixtures/error_fail␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/plugins_events/fixtures/error_fail␊
    ␊
    > Config file␊
      packages/build/tests/plugins_events/fixtures/error_fail/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/error_fail␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    ./plugin.js (onError event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    Plugin "./plugin.js" internal error                           ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: onError␊
    ␊
      Plugin details␊
      Package:        ./plugin.js␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onError" event in "./plugin.js" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/error_fail␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    Plugin "./plugin.js" internal error                           ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: onBuild␊
    ␊
      Plugin details␊
      Package:        ./plugin.js␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onBuild" event in "./plugin.js" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/error_fail␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js`

## plugin.onError gets an error argument

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/plugins_events/fixtures/error_argument␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/plugins_events/fixtures/error_argument␊
    ␊
    > Config file␊
      packages/build/tests/plugins_events/fixtures/error_argument/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/error_argument␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    test␊
    ␊
    ./plugin.js (onError event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    TestError␊
    test␊
    TestError: test␊
    STACK TRACE␊
    ␊
    (./plugin.js onError completed in 1ms)␊
    Build step duration: ./plugin.js onError completed in 1ms␊
    ␊
    Plugin "./plugin.js" internal error                           ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      TestError: test␊
    ␊
      Plugin details␊
      Package:        ./plugin.js␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onBuild" event in "./plugin.js" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/error_argument␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js`

## plugin.onError can be used in several plugins

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/plugins_events/fixtures/error_several␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/plugins_events/fixtures/error_several␊
    ␊
    > Config file␊
      packages/build/tests/plugins_events/fixtures/error_several/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/error_several␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
        - inputs: {}␊
          origin: config␊
          package: ./handler_one.js␊
        - inputs: {}␊
          origin: config␊
          package: ./handler_two.js␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
       - ./handler_one.js@1.0.0 from netlify.toml␊
       - ./handler_two.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    ./handler_one.js (onError event)                              ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    Plugin "./handler_one.js" internal error                      ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: onError␊
    ␊
      Plugin details␊
      Package:        ./handler_one.js␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onError" event in "./handler_one.js" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/error_several␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
        - inputs: {}␊
          origin: config␊
          package: ./handler_one.js␊
        - inputs: {}␊
          origin: config␊
          package: ./handler_two.js␊
    ␊
    ./handler_two.js (onError event)                              ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onBuild␊
    ␊
    (./handler_two.js onError completed in 1ms)␊
    Build step duration: ./handler_two.js onError completed in 1ms␊
    ␊
    Plugin "./plugin.js" internal error                           ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: onBuild␊
    ␊
      Plugin details␊
      Package:        ./plugin.js␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onBuild" event in "./plugin.js" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/error_several␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
        - inputs: {}␊
          origin: config␊
          package: ./handler_one.js␊
        - inputs: {}␊
          origin: config␊
          package: ./handler_two.js`

## plugin.onEnd is triggered on success

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/plugins_events/fixtures/end_ok␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/plugins_events/fixtures/end_ok␊
    ␊
    > Config file␊
      packages/build/tests/plugins_events/fixtures/end_ok/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/end_ok␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onBuild␊
    ␊
    (./plugin.js onBuild completed in 1ms)␊
    Build step duration: ./plugin.js onBuild completed in 1ms␊
    ␊
    ./plugin.js (onEnd event)                                     ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onEnd␊
    ␊
    (./plugin.js onEnd completed in 1ms)␊
    Build step duration: ./plugin.js onEnd completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## plugin.onEnd is triggered on failure

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/plugins_events/fixtures/end_not_ok␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/plugins_events/fixtures/end_not_ok␊
    ␊
    > Config file␊
      packages/build/tests/plugins_events/fixtures/end_not_ok/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/end_not_ok␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    ./plugin.js (onEnd event)                                     ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onEnd␊
    ␊
    (./plugin.js onEnd completed in 1ms)␊
    Build step duration: ./plugin.js onEnd completed in 1ms␊
    ␊
    Plugin "./plugin.js" internal error                           ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: onBuild␊
    ␊
      Plugin details␊
      Package:        ./plugin.js␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onBuild" event in "./plugin.js" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/end_not_ok␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js`

## plugin.onEnd is not triggered on failPlugin()

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/plugins_events/fixtures/end_fail_plugin␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/plugins_events/fixtures/end_fail_plugin␊
    ␊
    > Config file␊
      packages/build/tests/plugins_events/fixtures/end_fail_plugin/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/end_fail_plugin␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    Plugin "./plugin.js" failed                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: onBuild␊
    ␊
      Plugin details␊
      Package:        ./plugin.js␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onBuild" event in "./plugin.js" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/end_fail_plugin␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## plugin.onEnd is triggered on cancelBuild()

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/plugins_events/fixtures/end_cancel_build␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/plugins_events/fixtures/end_cancel_build␊
    ␊
    > Config file␊
      packages/build/tests/plugins_events/fixtures/end_cancel_build/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/end_cancel_build␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    ./plugin.js (onEnd event)                                     ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onEnd␊
    ␊
    (./plugin.js onEnd completed in 1ms)␊
    Build step duration: ./plugin.js onEnd completed in 1ms␊
    ␊
    Build canceled by ./plugin.js                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      onBuild␊
    `

## plugin.onEnd can fail but it does not stop builds

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/plugins_events/fixtures/end_fail␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/plugins_events/fixtures/end_fail␊
    ␊
    > Config file␊
      packages/build/tests/plugins_events/fixtures/end_fail/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/end_fail␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onEnd event)                                     ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    Plugin "./plugin.js" internal error                           ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: onEnd␊
    ␊
      Plugin details␊
      Package:        ./plugin.js␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onEnd" event in "./plugin.js" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/end_fail␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`

## plugin.onEnd and plugin.onError can be used together

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/plugins_events/fixtures/end_error␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/plugins_events/fixtures/end_error␊
    ␊
    > Config file␊
      packages/build/tests/plugins_events/fixtures/end_error/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/end_error␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    ./plugin.js (onError event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onError␊
    ␊
    (./plugin.js onError completed in 1ms)␊
    Build step duration: ./plugin.js onError completed in 1ms␊
    ␊
    ./plugin.js (onEnd event)                                     ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onEnd␊
    ␊
    (./plugin.js onEnd completed in 1ms)␊
    Build step duration: ./plugin.js onEnd completed in 1ms␊
    ␊
    Plugin "./plugin.js" internal error                           ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: onBuild␊
    ␊
      Plugin details␊
      Package:        ./plugin.js␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onBuild" event in "./plugin.js" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/end_error␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js`

## plugin.onEnd can be used in several plugins

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/plugins_events/fixtures/end_several␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/plugins_events/fixtures/end_several␊
    ␊
    > Config file␊
      packages/build/tests/plugins_events/fixtures/end_several/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/end_several␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
        - inputs: {}␊
          origin: config␊
          package: ./handler_one.js␊
        - inputs: {}␊
          origin: config␊
          package: ./handler_two.js␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
       - ./handler_one.js@1.0.0 from netlify.toml␊
       - ./handler_two.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    ./handler_one.js (onEnd event)                                ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onEnd one␊
    ␊
    (./handler_one.js onEnd completed in 1ms)␊
    Build step duration: ./handler_one.js onEnd completed in 1ms␊
    ␊
    ./handler_two.js (onEnd event)                                ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onEnd two␊
    ␊
    (./handler_two.js onEnd completed in 1ms)␊
    Build step duration: ./handler_two.js onEnd completed in 1ms␊
    ␊
    Plugin "./plugin.js" internal error                           ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: onBuild␊
    ␊
      Plugin details␊
      Package:        ./plugin.js␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onBuild" event in "./plugin.js" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/end_several␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
        - inputs: {}␊
          origin: config␊
          package: ./handler_one.js␊
        - inputs: {}␊
          origin: config␊
          package: ./handler_two.js`

## Does not run `*Dev` events on the build timeline

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: false␊
    ␊
    > Current directory␊
      packages/build/tests/plugins_events/fixtures/dev_and_build␊
    ␊
    > Config file␊
      packages/build/tests/plugins_events/fixtures/dev_and_build/netlify.toml␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onPreBuild event)                                ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onPreBuild: {␊
      CONFIG_PATH: 'netlify.toml',␊
      FUNCTIONS_DIST: '.netlify/functions/',␊
      EDGE_FUNCTIONS_DIST: '.netlify/edge-functions-dist/',␊
      CACHE_DIR: '.netlify/cache',␊
      IS_LOCAL: true,␊
      NETLIFY_BUILD_VERSION: '1.0.0',␊
      NETLIFY_API_HOST: 'api.netlify.com',␊
      INTERNAL_FUNCTIONS_SRC: '.netlify/functions-internal',␊
      INTERNAL_EDGE_FUNCTIONS_SRC: '.netlify/edge-functions',␊
      PUBLISH_DIR: '.'␊
    }␊
    ␊
    (./plugin.js onPreBuild completed in 1ms)␊
    ␊
    ./plugin.js (onBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onBuild: {␊
      CONFIG_PATH: 'netlify.toml',␊
      FUNCTIONS_DIST: '.netlify/functions/',␊
      EDGE_FUNCTIONS_DIST: '.netlify/edge-functions-dist/',␊
      CACHE_DIR: '.netlify/cache',␊
      IS_LOCAL: true,␊
      NETLIFY_BUILD_VERSION: '1.0.0',␊
      NETLIFY_API_HOST: 'api.netlify.com',␊
      INTERNAL_FUNCTIONS_SRC: '.netlify/functions-internal',␊
      INTERNAL_EDGE_FUNCTIONS_SRC: '.netlify/edge-functions',␊
      PUBLISH_DIR: '.'␊
    }␊
    ␊
    (./plugin.js onBuild completed in 1ms)␊
    ␊
    ./plugin.js (onPostBuild event)                               ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onPostBuild: {␊
      CONFIG_PATH: 'netlify.toml',␊
      FUNCTIONS_DIST: '.netlify/functions/',␊
      EDGE_FUNCTIONS_DIST: '.netlify/edge-functions-dist/',␊
      CACHE_DIR: '.netlify/cache',␊
      IS_LOCAL: true,␊
      NETLIFY_BUILD_VERSION: '1.0.0',␊
      NETLIFY_API_HOST: 'api.netlify.com',␊
      INTERNAL_FUNCTIONS_SRC: '.netlify/functions-internal',␊
      INTERNAL_EDGE_FUNCTIONS_SRC: '.netlify/edge-functions',␊
      PUBLISH_DIR: '.'␊
    }␊
    ␊
    (./plugin.js onPostBuild completed in 1ms)␊
    ␊
    ./plugin.js (onSuccess event)                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onSuccess: {␊
      CONFIG_PATH: 'netlify.toml',␊
      FUNCTIONS_DIST: '.netlify/functions/',␊
      EDGE_FUNCTIONS_DIST: '.netlify/edge-functions-dist/',␊
      CACHE_DIR: '.netlify/cache',␊
      IS_LOCAL: true,␊
      NETLIFY_BUILD_VERSION: '1.0.0',␊
      NETLIFY_API_HOST: 'api.netlify.com',␊
      INTERNAL_FUNCTIONS_SRC: '.netlify/functions-internal',␊
      INTERNAL_EDGE_FUNCTIONS_SRC: '.netlify/edge-functions',␊
      PUBLISH_DIR: '.'␊
    }␊
    ␊
    (./plugin.js onSuccess completed in 1ms)␊
    ␊
    ./plugin.js (onEnd event)                                     ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onEnd: {␊
      CONFIG_PATH: 'netlify.toml',␊
      FUNCTIONS_DIST: '.netlify/functions/',␊
      EDGE_FUNCTIONS_DIST: '.netlify/edge-functions-dist/',␊
      CACHE_DIR: '.netlify/cache',␊
      IS_LOCAL: true,␊
      NETLIFY_BUILD_VERSION: '1.0.0',␊
      NETLIFY_API_HOST: 'api.netlify.com',␊
      INTERNAL_FUNCTIONS_SRC: '.netlify/functions-internal',␊
      INTERNAL_EDGE_FUNCTIONS_SRC: '.netlify/edge-functions',␊
      PUBLISH_DIR: '.'␊
    }␊
    ␊
    (./plugin.js onEnd completed in 1ms)␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)`

## Runs the `*Dev` events and not the `*Build` events on the dev timeline

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: false␊
    ␊
    > Current directory␊
      packages/build/tests/plugins_events/fixtures/dev_and_build␊
    ␊
    > Config file␊
      packages/build/tests/plugins_events/fixtures/dev_and_build/netlify.toml␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onPreDev event)                                  ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onPreDev: {␊
      CONFIG_PATH: 'netlify.toml',␊
      FUNCTIONS_DIST: '.netlify/functions/',␊
      EDGE_FUNCTIONS_DIST: '.netlify/edge-functions-dist/',␊
      CACHE_DIR: '.netlify/cache',␊
      IS_LOCAL: true,␊
      NETLIFY_BUILD_VERSION: '1.0.0',␊
      NETLIFY_API_HOST: 'api.netlify.com',␊
      INTERNAL_FUNCTIONS_SRC: '.netlify/functions-internal',␊
      INTERNAL_EDGE_FUNCTIONS_SRC: '.netlify/edge-functions',␊
      PUBLISH_DIR: '.'␊
    }␊
    ␊
    (./plugin.js onPreDev completed in 1ms)␊
    ␊
    ./plugin.js (onDev event)                                     ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onDev: {␊
      CONFIG_PATH: 'netlify.toml',␊
      FUNCTIONS_DIST: '.netlify/functions/',␊
      EDGE_FUNCTIONS_DIST: '.netlify/edge-functions-dist/',␊
      CACHE_DIR: '.netlify/cache',␊
      IS_LOCAL: true,␊
      NETLIFY_BUILD_VERSION: '1.0.0',␊
      NETLIFY_API_HOST: 'api.netlify.com',␊
      INTERNAL_FUNCTIONS_SRC: '.netlify/functions-internal',␊
      INTERNAL_EDGE_FUNCTIONS_SRC: '.netlify/edge-functions',␊
      PUBLISH_DIR: '.'␊
    }␊
    ␊
    (./plugin.js onDev completed in 1ms)␊
    ␊
    Run command for local development                             ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    (dev1.0.0command completed in 1ms)`

## Keeps output to a minimum in the `startDev` entrypoint when `quiet: true`

> Snapshot 1

    `␊
    ./plugin.js (onPreDev event)                                  ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onPreDev: {␊
      CONFIG_PATH: 'netlify.toml',␊
      FUNCTIONS_DIST: '.netlify/functions/',␊
      EDGE_FUNCTIONS_DIST: '.netlify/edge-functions-dist/',␊
      CACHE_DIR: '.netlify/cache',␊
      IS_LOCAL: true,␊
      NETLIFY_BUILD_VERSION: '1.0.0',␊
      NETLIFY_API_HOST: 'api.netlify.com',␊
      INTERNAL_FUNCTIONS_SRC: '.netlify/functions-internal',␊
      INTERNAL_EDGE_FUNCTIONS_SRC: '.netlify/edge-functions',␊
      PUBLISH_DIR: '.'␊
    }␊
    ␊
    (./plugin.js onPreDev completed in 1ms)␊
    ␊
    ./plugin.js (onDev event)                                     ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onDev: {␊
      CONFIG_PATH: 'netlify.toml',␊
      FUNCTIONS_DIST: '.netlify/functions/',␊
      EDGE_FUNCTIONS_DIST: '.netlify/edge-functions-dist/',␊
      CACHE_DIR: '.netlify/cache',␊
      IS_LOCAL: true,␊
      NETLIFY_BUILD_VERSION: '1.0.0',␊
      NETLIFY_API_HOST: 'api.netlify.com',␊
      INTERNAL_FUNCTIONS_SRC: '.netlify/functions-internal',␊
      INTERNAL_EDGE_FUNCTIONS_SRC: '.netlify/edge-functions',␊
      PUBLISH_DIR: '.'␊
    }␊
    ␊
    (./plugin.js onDev completed in 1ms)␊
    ␊
    Run command for local development                             ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    ␊
    (dev1.0.0command completed in 1ms)`

## Shows error information in the `startDev` entrypoint even when `quiet: true`

> Snapshot 1

    `␊
    ./plugin.js (onPreDev event)                                  ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onPreDev: {␊
      CONFIG_PATH: 'netlify.toml',␊
      FUNCTIONS_DIST: '.netlify/functions/',␊
      EDGE_FUNCTIONS_DIST: '.netlify/edge-functions-dist/',␊
      CACHE_DIR: '.netlify/cache',␊
      IS_LOCAL: true,␊
      NETLIFY_BUILD_VERSION: '1.0.0',␊
      NETLIFY_API_HOST: 'api.netlify.com',␊
      INTERNAL_FUNCTIONS_SRC: '.netlify/functions-internal',␊
      INTERNAL_EDGE_FUNCTIONS_SRC: '.netlify/edge-functions',␊
      PUBLISH_DIR: '.'␊
    }␊
    ␊
    Plugin "./plugin.js" internal error                           ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
      Error message␊
      Error: Houston, we have a problem.␊
    ␊
      Plugin details␊
      Package:        ./plugin.js␊
      Version:        1.0.0␊
      Repository:     git+https://github.com/netlify/build.git␊
      Report issues:  https://github.com/netlify/build/issues␊
    ␊
      Error location␊
      In "onPreDev" event in "./plugin.js" from netlify.toml␊
    STACK TRACE␊
    ␊
      Resolved config␊
      build:␊
        publish: packages/build/tests/plugins_events/fixtures/dev_with_error␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js`

## Merges configuration from the Deploy Configuration API

> Snapshot 1

    `␊
    Netlify Build                                                 ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    > Version␊
      @netlify/build 1.0.0␊
    ␊
    > Flags␊
      debug: true␊
      repositoryRoot: packages/build/tests/plugins_events/fixtures/deploy_config␊
      testOpts:␊
        pluginsListUrl: test␊
        silentLingeringProcesses: true␊
    ␊
    > Current directory␊
      packages/build/tests/plugins_events/fixtures/deploy_config␊
    ␊
    > Config file␊
      packages/build/tests/plugins_events/fixtures/deploy_config/netlify.toml␊
    ␊
    > Resolved config␊
      build:␊
        command: echo Hello␊
        commandOrigin: config␊
        publish: packages/build/tests/plugins_events/fixtures/deploy_config␊
        publishOrigin: default␊
      plugins:␊
        - inputs: {}␊
          origin: config␊
          package: ./plugin.js␊
      redirects:␊
        - from: /external/path␊
          status: 200␊
          to: /external/path␊
      redirectsOrigin: config␊
    ␊
    > Context␊
      production␊
    ␊
    > Loading plugins␊
       - ./plugin.js@1.0.0 from netlify.toml␊
    ␊
    ./plugin.js (onPreBuild event)                                ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onPreBuild: {␊
      redirectsOrigin: 'config',␊
      functions: { '*': {} },␊
      plugins: [ { package: './plugin.js', origin: 'config', inputs: {} } ],␊
      build: {␊
        environment: {},␊
        publish: 'packages/build/tests/plugins_events/fixtures/deploy_config',␊
        publishOrigin: 'default',␊
        processing: { css: {}, html: {}, images: {}, js: {} },␊
        services: {},␊
        command: 'echo Hello',␊
        commandOrigin: 'config'␊
      },␊
      headers: [],␊
      redirects: [␊
        {␊
          from: '/external/path',␊
          query: {},␊
          to: '/external/path',␊
          status: 200,␊
          force: false,␊
          conditions: {},␊
          headers: {}␊
        }␊
      ]␊
    }␊
    ␊
    (./plugin.js onPreBuild completed in 1ms)␊
    Build step duration: ./plugin.js onPreBuild completed in 1ms␊
    ␊
    build.command from netlify.toml                               ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    $ echo Hello␊
    Hello␊
    ␊
    (build.command completed in 1ms)␊
    Build step duration: build.command completed in 1ms␊
    ␊
    ./plugin.js (onBuild event)                                   ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    onBuild: {␊
      redirectsOrigin: 'config',␊
      functions: { '*': {}, 'my_framework*': { included_files: [Array] } },␊
      plugins: [ { package: './plugin.js', origin: 'config', inputs: {} } ],␊
      build: {␊
        environment: {},␊
        publish: 'packages/build/tests/plugins_events/fixtures/deploy_config',␊
        publishOrigin: 'default',␊
        processing: { css: {}, html: {}, images: {}, js: {} },␊
        services: {},␊
        command: 'echo Hello',␊
        commandOrigin: 'config'␊
      },␊
      headers: [],␊
      redirects: [␊
        {␊
          from: '/external/path',␊
          query: {},␊
          to: '/external/path',␊
          status: 200,␊
          force: false,␊
          conditions: {},␊
          headers: {}␊
        },␊
        {␊
          from: '/external/path',␊
          to: '/external/path',␊
          status: 418,␊
          force: true␊
        }␊
      ]␊
    }␊
    ␊
    (./plugin.js onBuild completed in 1ms)␊
    Build step duration: ./plugin.js onBuild completed in 1ms␊
    ␊
    Netlify Build Complete                                        ␊
    ────────────────────────────────────────────────────────────────␊
    ␊
    (Netlify Build completed in 1ms)␊
    Build step duration: Netlify Build completed in 1ms`
