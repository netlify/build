# Getting Starts with Netlify build

Welcome Netlify users!

We are excited to show you a preview of `Netlify Build`.

## About

`Netlify Build` is the next generation of CI/CD tooling for modern web applications.

It is designed to support any kind of build flow and is extendable to fit any unique project requirements.

Today, we are going to setup and use `Netlify Build`

## Tutorial

1. Create your site as you normally would

2. Commit that code to your git repo

3. Create a `Netlify Config` file

   a. **Starting from scratch**

   1. Create a `netlify.yml` file in your sites root directory

   2. Example config

   ```yml
   build:
     # `functions` is the directory with the serverless Lambda functions to deploy to AWS.
     functions: src/functions
     # `publish` is the directory (relative to root of your repo) that contains the deploy-ready
     # HTML files and assets generated by the build.
     publish: build
     # `lifecycle` is how your build runs
     lifecycle:
       init:
         - echo "Starting the build"
       build:
         - npm run build
         - echo 'wow thing ran!'
   ```

   b. **Converting existing `netlify.toml`**

   1. Convert toml file to yml

   2. Move build command into build.lifecycle.build

4. Lets install & run `Netlify Build` locally

   Install from npm

   ```bash
   npm install @netlify/build -g
   ```

   Now inside your site directory run

   ```bash
   netlify-build
   ```

5. Install a plugin

   Let's install the sitemap plugin from `npm`

   ```bash
   npm install @netlify/sitemap-plugin
   ```

   After installing, add the plugin to your `Netlify Config`

   ```yml
   # `plugins` are all netlify plugins installed for the site
   plugins:
     - netlify/sitemap-plugin:
         enabled: true

   build:
     # `functions` is the directory with the serverless functions to deploy to AWS.
     functions: src/functions
     # `publish` is the directory (relative to root of your repo) that contains the deploy-ready
     # HTML files and assets generated by the build.
     publish: build
     # `lifecycle` is how your build runs
     lifecycle:
       init:
         - echo "Starting the build"
       build:
         - npm run build
         - echo 'wow thing ran!'
   ```

6. Lets now create a plugin

   We will setup a plugin locally in our project. This makes it easier to iterate on before publishing to npm.

   1. Create a plugins folder

   ```
   mkdir plugins
   ```

   You should now have a `root/plugins`

   2. Create a plugin inside the plugins folder

   ```
   mkdir plugins/my-first-plugin
   ```

   You should now have a `root/plugins/my-first-plugin`

   3. Add in plugin code

   ```js
   module.exports = function myFirstPlugin(config) {
     return {
       buildEnd: () => {
         console.log('This runs after build')
       }
     }
   }
   ```

   The `buildEnd` function exported here corresponds to the `buildEnd` lifecycle hook.

   You can [see all lifecycle events here](https://github.com/netlify/netlify-build/blob/master/packages/build-core/src/build.js#L18-L39)

   4. Include your plugin

   ```yml
   # `plugins` are all netlify plugins installed for the site
   plugins:
     # Local plugin
     - ./plugins/my-first-plugin:
         enabled: true
     # Plugin from npm
     - netlify/sitemap-plugin:
         enabled: true

   build:
     # `functions` is the directory with the serverless functions to deploy to AWS.
     functions: src/functions
     # `publish` is the directory (relative to root of your repo) that contains the deploy-ready
     # HTML files and assets generated by the build.
     publish: build
     # `lifecycle` is how your build runs
     lifecycle:
       init:
         - echo "Starting the build"
       build:
         - npm run build
         - echo 'wow thing ran!'
   ```

7. Run `Netlify Build` locally

   Now inside your site directory run

   ```bash
   netlify-build
   ```

8. Create a site in Netlify and connect your repo

   Set the a `NETLIFY_BUILD_LIFECYCLE_TRIAL` environment variable in your site and set it's value to `enabled=true`

9. Trigger a build

   `Netlify Build` will now run automatically on git commits

10. Fin ðŸŽ‰
    <!-- ## Concepts

`Netlify Build` introduces a couple new features to your build process.

1. A powerful build lifecycle
2. Environment variable support
   -->
